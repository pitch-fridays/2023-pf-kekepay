<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="../Css/agentDashboard__pass.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css">
    <script src="main.js"></script>
</head>

<body>

    <!-- ASIDE START -->
    <div class="container">
        <aside>
            <div class="container__aside">
                <div class="links__top">
                    <img class="logo" src="../Images__Dashboard/logo.jpg" alt="">
                    <li><a class="first" href="../HTML/agentDashboard.html"><i
                                class="uil uil-create-dashboard"></i>Dashboard</a></li>
                    <li><a class="second" href="agentDashboard__history.html"><i
                                class="uil uil-transaction"></i>History</a></li>
                    <li><a class="third" href="../HTML/agentDashboard__Settings.html"><i
                                class="uil uil-notes"></i>Settings</a></li>

                </div>

                <div class="links__bottom">
                    <li><a href="">Support</a></li>
                    <li><a href="Agent Login.html">Log out <i class="uil uil-signout"></i></a></li>
                </div>
            </div>
        </aside>
        <!-- ASIDE END -->

        <div class="password__container">
            <nav>
                <li><a id="profile" href="../HTML/agentDashboard__Settings.html">My Profile</a></li>
                <li id="Password"><a href="../HTML/agentDashboard__pass.html">Password</a></li>
            </nav>

            <div class="inner__Container">
                <div class="others">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36" fill="none">
                        <path
                            d="M23.625 2.25C22.0439 2.24964 20.4847 2.61964 19.0724 3.33035C17.6601 4.04106 16.4338 5.07272 15.492 6.34266C14.5501 7.61259 13.9189 9.08549 13.6488 10.6433C13.3786 12.2012 13.4772 13.8006 13.9365 15.3135L2.25 27V33.75H9L20.6865 22.0635C22.0791 22.4862 23.5465 22.6037 24.9887 22.4081C26.4309 22.2124 27.8139 21.7081 29.0436 20.9295C30.2732 20.151 31.3206 19.1165 32.1142 17.8966C32.9079 16.6767 33.4293 15.3 33.6428 13.8604C33.8563 12.4207 33.7569 10.952 33.3515 9.55422C32.946 8.15646 32.244 6.86254 31.2932 5.76063C30.3425 4.65872 29.1653 3.77474 27.842 3.16891C26.5187 2.56309 25.0804 2.24966 23.625 2.25ZM23.625 20.25C22.8505 20.2496 22.0802 20.1351 21.339 19.9102L20.0486 19.5188L19.0958 20.4716L15.5171 24.0503L13.9657 22.5L12.375 24.0907L13.9264 25.6421L12.1421 27.4264L10.5907 25.875L9 27.4657L10.5514 29.0171L8.0685 31.5H4.5V27.9315L15.5273 16.9043L16.4812 15.9514L16.0898 14.661C15.6089 13.0759 15.6401 11.3795 16.179 9.81311C16.7179 8.24676 17.737 6.89021 19.0913 5.93643C20.4456 4.98265 22.0662 4.48022 23.7225 4.5006C25.3789 4.52097 26.9866 5.06313 28.317 6.04993C29.6475 7.03674 30.6329 8.41795 31.1331 9.99709C31.6332 11.5762 31.6227 13.2729 31.103 14.8457C30.5833 16.4185 29.5809 17.7874 28.2383 18.7577C26.8958 19.7279 25.2815 20.2501 23.625 20.25Z"
                            fill="black" fill-opacity="0.5" />
                        <path
                            d="M20.25 17.5C21.4926 17.5 22.5 16.4926 22.5 15.25C22.5 14.0074 21.4926 13 20.25 13C19.0074 13 18 14.0074 18 15.25C18 16.4926 19.0074 17.5 20.25 17.5Z"
                            fill="black" fill-opacity="0.5" />
                    </svg>
                    <h4>Change Password</h4>
                    <div class="btns">
                        <button id="second">Save Changes</button>
                    </div>
                </div>


                <div class="change__password">
                    <h4>Current Password</h4>
                    <input type="password" id="currentPassword">

                    <h4>New Password</h4>
                    <input type="password" id="newPassword">

                    <h4>Confirm Password</h4>
                    <input type="password" id="confirmPassword">

                    <!-- 
            <div class="change__pin">
               <div class="icons">
                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36" fill="none">
                    <path d="M23.625 2.25C22.0439 2.24964 20.4847 2.61964 19.0724 3.33035C17.6601 4.04106 16.4338 5.07272 15.492 6.34266C14.5501 7.61259 13.9189 9.08549 13.6488 10.6433C13.3786 12.2012 13.4772 13.8006 13.9365 15.3135L2.25 27V33.75H9L20.6865 22.0635C22.0791 22.4862 23.5465 22.6037 24.9887 22.4081C26.4309 22.2124 27.8139 21.7081 29.0436 20.9295C30.2732 20.151 31.3206 19.1165 32.1142 17.8966C32.9079 16.6767 33.4293 15.3 33.6428 13.8604C33.8563 12.4207 33.7569 10.952 33.3515 9.55422C32.946 8.15646 32.244 6.86254 31.2932 5.76063C30.3425 4.65872 29.1653 3.77474 27.842 3.16891C26.5187 2.56309 25.0804 2.24966 23.625 2.25ZM23.625 20.25C22.8505 20.2496 22.0802 20.1351 21.339 19.9102L20.0486 19.5188L19.0958 20.4716L15.5171 24.0503L13.9657 22.5L12.375 24.0907L13.9264 25.6421L12.1421 27.4264L10.5907 25.875L9 27.4657L10.5514 29.0171L8.0685 31.5H4.5V27.9315L15.5273 16.9043L16.4812 15.9514L16.0898 14.661C15.6089 13.0759 15.6401 11.3795 16.179 9.81311C16.7179 8.24676 17.737 6.89021 19.0913 5.93643C20.4456 4.98265 22.0662 4.48022 23.7225 4.5006C25.3789 4.52097 26.9866 5.06313 28.317 6.04993C29.6475 7.03674 30.6329 8.41795 31.1331 9.99709C31.6332 11.5762 31.6227 13.2729 31.103 14.8457C30.5833 16.4185 29.5809 17.7874 28.2383 18.7577C26.8958 19.7279 25.2815 20.2501 23.625 20.25Z" fill="black" fill-opacity="0.5"/>
                    <path d="M20.25 17.5C21.4926 17.5 22.5 16.4926 22.5 15.25C22.5 14.0074 21.4926 13 20.25 13C19.0074 13 18 14.0074 18 15.25C18 16.4926 19.0074 17.5 20.25 17.5Z" fill="black" fill-opacity="0.5"/>
                  </svg>
                  <h4>Change Password</h4>
               </div>
               
                <h4>Current Pin</h4>
            <input type="password">

            <h4>New Pin</h4>
            <input type="password">

            <h4>Confirm Pin</h4>
            <input type="password">
            </div> -->

                </div>

            </div>
        </div>
    </div>
    </div>


    <script>
        // Function to change user password
        const btn = document.getElementById('second')
        btn.addEventListener('click', async function (e) {
            e.preventDefault();

            // const baseUrl = 'http://localhost:5500';
            const baseUrl = 'https://keke-pay.onrender.com'
            const agentId = localStorage.getItem('agentId');
            console.log(agentId);
            // console.log(userId);

            const changePassword = async () => {
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                console.log(currentPassword);
                console.log(newPassword);
                console.log(confirmPassword);
                try {
                    const response = await fetch(`${baseUrl}/change-password/${agentId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            currentPassword,
                            newPassword,
                            confirmPassword,
                        }),
                    });

                    const data = await response.json();
                    if (response.ok) {
                        alert(`${data.message}`);
                    } else {
                        // alert(`Failed to update profile. Error: ${data.message}`);
                        alert(`${data.message}`);

                    }

                    // Handle the response as needed 
                    console.log(data);
                } catch (error) {
                    console.error('Error changing password:', error);
                    alert(`${data.message}`);
                }
            };

            changePassword();

        });

    </script>
</body>

</html>